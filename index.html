<!DOCTYPE html>
<html lang="en" translate="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#0ea5e9">
  <meta name="google" content="notranslate">
  <link rel="manifest" href="manifest.json">
  <title>Dreamex DataLab - Enterprise Management Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Add Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Add Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Local CSS Files -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/modal.css">
  <link rel="stylesheet" href="css/modal-styles.css">
  <link rel="stylesheet" href="css/forms.css">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Poppins', 'sans-serif'],
          },
          colors: {
            primary: {
              50: '#f0f9ff',
              100: '#e0f2fe',
              200: '#bae6fd',
              300: '#7dd3fc',
              400: '#38bdf8',
              500: '#0ea5e9',
              600: '#0284c7',
              700: '#0369a1',
              800: '#075985',
              900: '#0c4a6e',
            },
          },
        }
      }
    }
  </script>
  <style>
    html {
      scroll-behavior: smooth;
    }
    
    /* Logo text protection - prevent wrapping and translation */
    header h1,
    .sidebar-logo h2 {
      white-space: nowrap !important;
      word-break: keep-all !important;
    }
    
    /* Prevent translation of brand name */
    [translate="no"] {
      -webkit-transform: none !important;
      transform: none !important;
    }
    
    /* Reinforce application view nav visibility - override Tailwind hidden */
    body.application-view nav,
    body.application-view #mainNav,
    html.app-view nav,
    html.app-view #mainNav { display:flex !important; visibility:visible !important; }
    body.application-view #loginButton,
    html.app-view #loginButton { display:inline-block !important; visibility:visible !important; }
    body.application-view #logoutButton { display:none !important; }
    body.application-view #userStatus { display:none !important; }
    /* Application View Mode (minimal) */
    html.app-view .app-band, body.application-view .app-band { display:none !important; }
    html.app-view body.application-view header { position:static; box-shadow:none; }
    body.application-view { background:#f8fafc; }
    body.application-view .login-focus-hint { display:block; }
    .login-focus-hint{ display:none; text-align:center; font-size:.75rem; color:#64748b; margin-top:.75rem; }
    
    .feature-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #0369a1 0%, #0ea5e9 100%);
    }
    
    .back-to-top {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 99;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .back-to-top.visible {
      opacity: 1;
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
      100% { transform: translateY(0px); }
    }
    
    .float-animation {
      animation: float 6s ease-in-out infinite;
    }
    
    .nav-link {
      position: relative;
    }
    
    .nav-link::after {
      content: "";
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -4px;
      left: 0;
      background-color: #0ea5e9;
      transition: width 0.3s;
    }
    
    .nav-link:hover::after {
      width: 100%;
    }
    
    /* Login Modal Styles */
    .login-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .login-modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .login-modal {
      background: white;
      border-radius: 24px;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.05);
      max-width: 1200px;
      width: 95%;
      max-height: 85vh;
      min-height: 600px;
      overflow: hidden;
      transform: scale(0.9) translateY(30px);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      position: relative;
    }
    
    .login-modal-overlay.active .login-modal {
      transform: scale(1) translateY(0);
    }
    
    .login-modal-left {
      background: linear-gradient(135deg, #0369a1 0%, #0ea5e9 50%, #06b6d4 100%);
      padding: 4rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: white;
      min-width: 450px;
      position: relative;
      overflow: hidden;
    }
    
    .login-modal-left::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="12" height="12" patternUnits="userSpaceOnUse"><path d="M 12 0 L 0 0 0 12" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      opacity: 0.4;
    }
    
    .login-modal-left::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }
    
    .login-modal-left .content {
      position: relative;
      z-index: 2;
    }
    
    .login-modal-right {
      padding: 4rem;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background: linear-gradient(145deg, #fafafa 0%, #ffffff 100%);
      position: relative;
    }
    
    .login-modal-right::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><defs><pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(59,130,246,0.03)"/></pattern></defs><rect width="60" height="60" fill="url(%23dots)"/></svg>');
      opacity: 0.5;
    }
    
    .login-form-container {
      max-width: 480px;
      margin: 0 auto;
      width: 100%;
      position: relative;
      z-index: 2;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      padding: 2.5rem;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Mobile: hide branding panel, make form full width */
    @media (max-width: 640px) {
      .login-modal {
        min-height: unset;
        height: auto;
        flex-direction: column;
        padding: 1rem 0;
      }
      .login-modal-left { display: none !important; }
      .login-modal-right { padding: 2rem 1.25rem; width: 100% !important; }
      .login-form-container { padding: 1.75rem 1.25rem; box-shadow: none; background: #ffffff; border-radius: 16px; }
      .login-modal-overlay { align-items: flex-start; }
      .modal-close { top: 8px; right: 8px; }
    }
    
    .form-group {
      margin-bottom: 1.8rem;
      position: relative;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.8rem;
      font-weight: 600;
      color: #374151;
      font-size: 1rem;
      transition: color 0.3s ease;
    }
    
    .form-input-container {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .form-input-container.has-icon input {
      padding-left: 3.2rem;
    }
    
    .form-input-icon {
      position: absolute;
      left: 1.2rem;
      color: #9ca3af;
      z-index: 2;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }
    
    .form-input-container:focus-within .form-input-icon {
      color: #3b82f6;
    }
    
    .login-modal input[type="email"], 
    .login-modal input[type="password"] {
      width: 100%;
      padding: 1rem 1.2rem;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
    }
    
    .login-modal input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.12), 0 8px 16px rgba(59, 130, 246, 0.15);
      transform: translateY(-1px);
      background: rgba(255, 255, 255, 0.95);
    }
    
    .password-field {
      position: relative;
    }
    
    .toggle-password {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      cursor: pointer;
      z-index: 3;
    }
    
    .remember-me {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }
    
    .remember-me input[type="checkbox"] {
      width: auto;
    }
    
    .remember-me label {
      font-size: 0.9rem;
      color: #6b7280;
      margin-bottom: 0;
    }
    
    .btn-login {
      width: 100%;
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 50%, #1e40af 100%);
      color: white;
      border: none;
      padding: 1.2rem 2rem;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.7rem;
      box-shadow: 0 8px 16px rgba(59, 130, 246, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .btn-login::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    
    .btn-login:hover::before {
      left: 100%;
    }
    
    .btn-login:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(59, 130, 246, 0.4);
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 50%, #1e3a8a 100%);
    }
    
    .loading-spinner {
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .login-options {
      text-align: center;
      margin-top: 1.5rem;
    }
    
    .login-options a {
      color: #3b82f6;
      text-decoration: none;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .login-options a:hover {
      text-decoration: underline;
      color: #1d4ed8;
    }
    
    .login-options p {
      color: #6b7280;
      font-size: 1rem;
      margin: 0.8rem 0;
    }
    
    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 40px;
      height: 40px;
      border: none;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      z-index: 10;
    }
    
    .modal-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.05);
    }
    
    #error-message {
      background: #fef2f2;
      color: #dc2626;
      padding: 0.8rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      border: 1px solid #fecaca;
      display: none;
    }
    
    @media (max-width: 1024px) {
      .login-modal {
        max-width: 950px;
        width: 92%;
      }
      
      .login-modal-left {
        min-width: 380px;
        padding: 3rem;
      }
      
      .login-form-container {
        max-width: 420px;
        padding: 2rem;
      }
    }
    
    @media (max-width: 768px) {
      .login-modal {
        flex-direction: column;
        max-width: 95%;
        max-height: 95vh;
        min-height: auto;
      }
      
      .login-modal-left {
        min-width: auto;
        padding: 2.5rem 2rem;
      }
      
      .login-modal-right {
        padding: 2rem;
      }
      
      .login-form-container {
        padding: 1.5rem;
        max-width: 100%;
      }
      
      .btn-login {
        padding: 1rem 1.5rem;
        font-size: 1rem;
      }
      
      .login-modal input[type="email"], 
      .login-modal input[type="password"] {
        padding: 0.9rem 1rem;
        font-size: 0.95rem;
      }
      
      .form-input-container.has-icon input {
        padding-left: 2.8rem;
      }
      
      .form-input-icon {
        left: 1rem;
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      .login-modal {
        width: 98%;
        margin: 1rem;
      }
      
      .login-modal-left {
        padding: 2rem 1.5rem;
      }
      
      .login-modal-right {
        padding: 1.5rem;
      }
      
      .login-form-container {
        padding: 1.25rem;
      }
    }
    
    /* Hide all sections except hero and footer on mobile and tablet */
    @media (max-width: 1024px) {
      .app-band,
      footer {
        display: none !important;
      }
      
      /* Reduce logo text size on mobile/tablet */
      header h1 {
        font-size: 0.875rem !important; /* text-sm - same as logout button */
        line-height: 1.25rem !important;
      }
      
      .sidebar-logo h2 {
        font-size: 0.875rem !important; /* text-sm */
        line-height: 1.25rem !important;
      }
    }
    
    /* Mobile App Sidebar Styles */
    .app-sidebar {
      display: none; /* Hidden by default */
      position: fixed;
      top: 0;
      left: 0;
      width: 280px;
      height: 100%;
      background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
      color: white;
      z-index: 9999;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      overflow-y: auto;
      padding: 1rem;
      box-shadow: none;
    }
    
    .app-view-active .app-sidebar {
      display: block;
    }
    
    .app-sidebar.mobile-active {
      transform: translateX(0);
      box-shadow: 4px 0 15px rgba(0, 0, 0, 0.3);
    }
    
    .sidebar-logo {
      text-align: center;
      padding: 1rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 2rem;
    }
    
    .sidebar-logo h2 {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0;
    }
    
    .sidebar-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .sidebar-menu li {
      margin-bottom: 0.5rem;
    }
    
    .sidebar-menu a {
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      transition: background-color 0.3s;
      font-size: 1rem;
    }
    
    .sidebar-menu a i {
      margin-right: 12px;
      font-size: 1.1rem;
    }
    
    .sidebar-menu a:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .mobile-sidebar-backdrop {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9998;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .mobile-sidebar-backdrop.active {
      display: block;
      opacity: 1;
    }
    
    /* Mobile menu button in header */
    .mobile-menu-btn {
      display: none;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.2rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }
    
    .mobile-menu-btn:hover {
      background: #2563eb;
      transform: scale(1.05);
    }
    
    .app-view-active .mobile-menu-btn {
      display: flex;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
  </style>
  <script>
    // EARLY application view detection - inject critical CSS immediately
    (function(){
      try {
        var qs = window.location.search.toLowerCase();
        var h = window.location.hash.toLowerCase();
        var isAppView = /(view=app|appview=1|mode=app|application-view|application=1)/.test(qs + h);
        
        if (isAppView) {
          // Inject critical inline styles IMMEDIATELY (before Tailwind loads)
          var style = document.createElement('style');
          style.id = 'app-view-override';
          style.textContent = `
            /* Critical app-view overrides - highest priority */
            .app-view-active #mainNav,
            .app-view-active nav { 
              display: flex !important; 
              visibility: visible !important;
              opacity: 1 !important;
            }
            .app-view-active #loginButton { 
              display: inline-block !important; 
              visibility: visible !important;
              opacity: 1 !important;
            }
            .app-view-active .app-band { 
              display: none !important; 
            }
            .app-view-active #logoutButton,
            .app-view-active #userStatus { 
              display: none !important; 
            }
          `;
          document.head.appendChild(style);
          
          // Add class to html immediately
          document.documentElement.classList.add('app-view');
          document.documentElement.classList.add('app-view-active');
          
          // Reinforce after DOM ready
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', applyAppView);
          } else {
            applyAppView();
          }
        }
        
        function applyAppView() {
          document.body.classList.add('application-view');
          document.body.classList.add('app-view-active');
          
          // Force element visibility with direct manipulation
          setTimeout(function(){
            var nav = document.getElementById('mainNav');
            var lb = document.getElementById('loginButton');
            
            if (nav) {
              nav.className = nav.className.replace(/\bhidden\b/g, '');
              nav.style.cssText = 'display: flex !important; visibility: visible !important;';
            }
            
            if (lb) {
              lb.className = lb.className.replace(/\bhidden\b/g, '');
              lb.style.cssText = 'display: inline-block !important; visibility: visible !important;';
            }
            
            // Hide marketing sections
            var bands = document.querySelectorAll('.app-band');
            for (var i = 0; i < bands.length; i++) {
              bands[i].style.display = 'none';
            }
          }, 0);
        }
      } catch(e){ console.warn('Early app-view detection failed', e); }
    })();
  </script>
  
  <!-- Firebase v8 CDN for domain compatibility -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <!-- GitHub Pages Fix Script -->
    <script src="github-pages-fix.js"></script>
    <script>
      // Register Service Worker early (non-blocking)
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js')
            .then(reg => console.log('[PWA] SW registered', reg.scope))
            .catch(err => console.warn('[PWA] SW registration failed', err));
        });
      }
    </script>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

  <!-- Header -->
  <header class="bg-white shadow-md p-4 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <div class="flex items-center">
        <div class="text-primary-600 mr-2">
          <i class="fas fa-chart-line text-3xl"></i>
        </div>
        <h1 class="text-2xl font-bold text-primary-700 whitespace-nowrap" translate="no">Dreamex DataLab</h1>
      </div>
  <nav id="mainNav" class="hidden md:flex space-x-8 items-center">
        <a href="dashboard.html" class="px-4 py-1.5 border border-primary-600 text-primary-700 font-medium rounded-full hover:bg-primary-50 transition duration-300 flex items-center gap-2" title="Go to Dashboard">
          <i class="fas fa-home"></i>
          Home
        </a>
        <a href="#features" class="nav-link text-gray-700 hover:text-primary-600 font-medium text-base">Features</a>
        <a href="pricing.html" class="nav-link text-gray-700 hover:text-primary-600 font-medium text-base">Pricing</a>
        <a href="#about" class="nav-link text-gray-700 hover:text-primary-600 font-medium text-base">About Us</a>
        <a href="#contact" class="nav-link text-gray-700 hover:text-primary-600 font-medium text-base">Contact</a>
        <div class="flex items-center">
          <div id="userStatus" class="hidden items-center mr-4">
            <i class="fas fa-user-circle text-primary-600 mr-2"></i>
            <span id="username" class="text-gray-700 font-medium"></span>
          </div>
          <button id="loginButton" class="px-6 py-1.5 bg-primary-600 text-white font-medium rounded-full hover:bg-primary-700 transition duration-300">Login</button>
          <button id="logoutButton" class="hidden px-6 py-1.5 bg-gray-600 text-white font-medium rounded-full hover:bg-gray-700 transition duration-300 ml-2">Logout</button>
        </div>
      </nav>
      <!-- Mobile Login Avatar/Button -->
      <div class="md:hidden flex items-center gap-2">
        <button id="mobileMenuToggle" class="mobile-menu-btn">
          <i class="fas fa-bars"></i>
        </button>
        <a href="dashboard.html" class="w-9 h-9 bg-primary-600 text-white rounded-full flex items-center justify-center hover:bg-primary-700 transition duration-300" title="Go to Dashboard">
          <i class="fas fa-home text-sm"></i>
        </a>
        <div id="mobileUserAvatar" class="hidden">
          <div class="avatar-initials w-9 h-9 bg-primary-600 text-white rounded-full flex items-center justify-center text-sm font-semibold cursor-pointer" id="mobileAvatarCircle">
            <i class="fas fa-user"></i>
          </div>
        </div>
        <button id="mobileLoginBtn" class="px-4 py-1.5 bg-primary-600 text-white font-medium rounded-full hover:bg-primary-700 transition duration-300 text-sm">Login</button>
        <button id="mobileLogoutBtn" class="hidden px-4 py-1.5 bg-gray-600 text-white font-medium rounded-full hover:bg-gray-700 transition duration-300 text-sm">Logout</button>
      </div>
    </div>
  </header>

  <!-- Mobile sidebar backdrop (for app view) -->
  <div id="mobileSidebarBackdrop" class="mobile-sidebar-backdrop"></div>

  <!-- Left Sidebar (for app view) -->
  <nav id="appSidebar" class="app-sidebar">
    <div class="sidebar-logo">
      <h2 class="whitespace-nowrap" translate="no">Dreamex DataLab</h2>
    </div>
    <ul class="sidebar-menu">
      <li><a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
      <li><a href="profile.html"><i class="fas fa-user"></i> Profile</a></li>
      <li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
      <li><a href="notifications.html"><i class="fas fa-bell"></i> Notifications</a></li>
      <li><a href="#" id="sidebarLogout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
    </ul>
  </nav>

  <!-- Hero Section -->
  <section class="gradient-bg text-white py-24 md:py-32 relative overflow-hidden">
    <!-- Abstract shapes in background -->
    <div class="absolute top-0 left-0 w-full h-full opacity-10">
      <div class="absolute top-10 left-10 w-40 h-40 bg-white rounded-full"></div>
      <div class="absolute bottom-20 right-20 w-60 h-60 bg-white rounded-full"></div>
      <div class="absolute top-40 right-40 w-20 h-20 bg-white rounded-full"></div>
    </div>
    
    <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center">
      <div class="md:w-1/2 mb-10 md:mb-0 text-center md:text-left">
  <h2 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">All-in-one solution for your enterprise operations</h2>
  <p class="text-lg md:text-xl mb-8 opacity-90">Unify HR, payroll, projects, inventory, fleet, and HSE with an intelligent, automated platform.</p>
        <div class="flex flex-col sm:flex-row justify-center md:justify-start space-y-4 sm:space-y-0 sm:space-x-4">
          <a href="#contact" class="px-8 py-3 bg-white text-primary-700 font-semibold rounded-full hover:bg-gray-100 transition duration-300 text-center">Request a Demo</a>
          <a href="#features" class="px-8 py-3 bg-transparent border-2 border-white text-white font-semibold rounded-full hover:bg-white/10 transition duration-300 text-center">Discover</a>
        </div>
      </div>
      <div class="md:w-1/2 float-animation">
  <img src="https://images.unsplash.com/photo-1553877522-43269d4ea984?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80" alt="Enterprise Dashboard Preview" class="rounded-xl shadow-2xl max-w-full h-auto">
      </div>
    </div>
  </section>

  <!-- Stats Section -->
  <section class="py-16 bg-white app-band">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div class="text-center">
          <div class="text-primary-600 text-4xl font-bold mb-2">98%</div>
          <div class="text-gray-600">Regulatory Compliance</div>
        </div>
        <div class="text-center">
          <div class="text-primary-600 text-4xl font-bold mb-2">75%</div>
          <div class="text-gray-600">Incident Reduction</div>
        </div>
        <div class="text-center">
          <div class="text-primary-600 text-4xl font-bold mb-2">50+</div>
          <div class="text-gray-600">Partner Companies</div>
        </div>
        <div class="text-center">
          <div class="text-primary-600 text-4xl font-bold mb-2">24/7</div>
          <div class="text-gray-600">Technical Support</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section id="features" class="py-20 bg-gray-50 app-band">
    <div class="max-w-6xl mx-auto px-6">
      <div class="text-center mb-16">
        <h3 class="text-3xl font-bold mb-4">Platform Features</h3>
        <p class="text-lg text-gray-600 max-w-3xl mx-auto">Our comprehensive platform offers integrated solutions for all your business operational needs across multiple domains.</p>
      </div>
      
      <!-- Features Loading State -->
      <div id="featuresLoadingState" class="text-center py-8">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"></div>
        <p class="mt-2 text-gray-600">Loading platform features...</p>
      </div>

      <!-- Dynamic Features Grid -->
      <div id="featuresGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" style="display: none;">
        <!-- Features will be dynamically loaded here -->
      </div>

      <!-- Features Empty State -->
      <div id="featuresEmptyState" class="text-center py-8" style="display: none;">
        <div class="text-gray-400 mb-4">
          <i class="fas fa-puzzle-piece text-6xl"></i>
        </div>
        <h4 class="text-xl font-semibold text-gray-600 mb-2">No Features Available</h4>
        <p class="text-gray-500">Platform features are currently being configured. Please check back later.</p>
      </div>

      <!-- Call to Action Button -->
      <div class="text-center mt-12">
        <button onclick="window.location.href='company-complete-registration.html'" 
                class="px-8 py-4 bg-primary-600 text-white font-semibold text-lg rounded-full hover:bg-primary-700 transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
          <i class="fas fa-rocket mr-2"></i>
          Start Your Free Trial
        </button>
        <p class="mt-3 text-gray-500 text-sm">No credit card required • Get started in minutes</p>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section id="about" class="py-20 gradient-bg text-white app-band">
    <div class="max-w-6xl mx-auto px-6">
      <div class="flex flex-col md:flex-row items-center">
        <div class="md:w-1/2 mb-10 md:mb-0">
          <img src="https://images.unsplash.com/photo-1551434678-e076c223a692?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&h=400&q=80" 
               alt="Enterprise Management Team" 
               class="rounded-xl shadow-lg max-w-full">
          <div class="mt-4 px-2 py-3 bg-white/10 backdrop-blur-sm rounded-lg">
            <p class="text-sm text-center">Our experienced enterprise solutions team brings over 15 years of combined industry expertise</p>
          </div>
        </div>
        <div class="md:w-1/2 md:pl-12">
          <h3 class="text-3xl font-bold mb-6">Why Dreamex DataLab?</h3>
          <p class="text-lg mb-6">Because modern enterprise management requires powerful, simple, and connected tools. Our mission is to help you digitalize your operations for sustainable performance across all departments.</p>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-8">
            <div class="flex items-start">
              <div class="mr-4 text-yellow-300">
                <i class="fas fa-check-circle text-xl"></i>
              </div>
              <div>
                <h4 class="font-semibold mb-2">Industry Expertise</h4>
                <p class="text-white/80">15+ years delivering enterprise software</p>
              </div>
            </div>
            <div class="flex items-start">
              <div class="mr-4 text-yellow-300">
                <i class="fas fa-check-circle text-xl"></i>
              </div>
              <div>
                <h4 class="font-semibold mb-2">Dedicated Support</h4>
                <p class="text-white/80">A team available 24/7</p>
              </div>
            </div>
            <div class="flex items-start">
              <div class="mr-4 text-yellow-300">
                <i class="fas fa-check-circle text-xl"></i>
              </div>
              <div>
                <h4 class="font-semibold mb-2">Scalable Solution</h4>
                <p class="text-white/80">Adapts to your growth</p>
              </div>
            </div>
            <div class="flex items-start">
              <div class="mr-4 text-yellow-300">
                <i class="fas fa-check-circle text-xl"></i>
              </div>
              <div>
                <h4 class="font-semibold mb-2">Guaranteed Compliance</h4>
                <p class="text-white/80">Regular regulatory updates</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Enterprise Image Gallery Section (New) -->
  <section class="py-16 bg-white app-band">
    <div class="max-w-6xl mx-auto px-6">
  <h3 class="text-3xl font-bold text-center mb-12">Enterprise in Action</h3>
      
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="overflow-hidden rounded-lg shadow-md">
          <img src="https://images.unsplash.com/photo-1587500154541-1cafd74f0efc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&h=200&q=80" 
               alt="Business analytics dashboard" class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
        </div>
        <div class="overflow-hidden rounded-lg shadow-md">
          <img src="https://images.unsplash.com/photo-1581092918056-0c4c3acd3789?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&h=200&q=80" 
               alt="Team collaboration" class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
        </div>
        <div class="overflow-hidden rounded-lg shadow-md">
          <img src="https://images.unsplash.com/photo-1581092580497-e0d23cbdf1dc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&h=200&q=80" 
               alt="Project planning" class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
        </div>
        <div class="overflow-hidden rounded-lg shadow-md">
          <img src="https://images.unsplash.com/photo-1540497077202-7c8a3999166f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=300&h=200&q=80" 
               alt="Warehouse and logistics" class="w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="py-20 bg-white app-band">
    <div class="max-w-6xl mx-auto px-6">
      <div class="text-center mb-16">
        <h3 class="text-3xl font-bold mb-4">Contact Us</h3>
        <p class="text-lg text-gray-600 max-w-3xl mx-auto">Interested in a demo or custom quote? Send us a message and our team will respond within 24 hours.</p>
      </div>
      
      <div class="flex flex-col md:flex-row gap-8">
        <div class="w-full">
          <div class="bg-white rounded-xl shadow-lg p-8 h-full">
            <form id="contactForm">
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6">
                <div>
                  <label class="block text-gray-700 mb-2" for="name">Full Name</label>
                  <input type="text" id="name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring focus:ring-primary-300 focus:border-primary-500 outline-none transition" placeholder="Your name">
                </div>
                <div>
                  <label class="block text-gray-700 mb-2" for="email">Business Email</label>
                  <input type="email" id="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring focus:ring-primary-300 focus:border-primary-500 outline-none transition" placeholder="youremail@company.com">
                </div>
              </div>
              
              <div class="mb-6">
                <label class="block text-gray-700 mb-2" for="company">Company</label>
                <input type="text" id="company" class="w-full p-3 border border-gray-300 rounded-lg focus:ring focus:ring-primary-300 focus:border-primary-500 outline-none transition" placeholder="Your company name">
              </div>
              
              <div class="mb-6">
                <label class="block text-gray-700 mb-2" for="message">Message</label>
                <textarea id="message" class="w-full p-3 border border-gray-300 rounded-lg focus:ring focus:ring-primary-300 focus:border-primary-500 outline-none transition h-32" placeholder="How can we help you?"></textarea>
              </div>
              
              <div>
                <button id="contactSubmitBtn" type="submit" class="w-full py-3 px-6 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition duration-300">Submit Request</button>
                <div id="contactStatus" class="mt-3 text-sm"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
      
      <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
        <div>
          <div class="text-primary-500 mb-4">
            <i class="fas fa-map-marker-alt text-3xl"></i>
          </div>
          <h4 class="text-xl font-semibold mb-2">Address</h4>
          <p class="text-gray-600">Kamsar cite, Boke, Guinée</p>
        </div>
        <div>
          <div class="text-primary-500 mb-4">
            <i class="fas fa-phone text-3xl"></i>
          </div>
          <h4 class="text-xl font-semibold mb-2">Phone</h4>
          <p class="text-gray-600">(+224) 62825767</p>
        </div>
        <div>
          <div class="text-primary-500 mb-4">
            <i class="fas fa-envelope text-3xl"></i>
          </div>
          <h4 class="text-xl font-semibold mb-2">Email</h4>
          <p class="text-gray-600">info@dreamexdatalab.com</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="max-w-6xl mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
        <div>
          <div class="flex items-center mb-4">
            <i class="fas fa-chart-line text-2xl text-primary-400 mr-2"></i>
            <h4 class="text-xl font-bold">Dreamex DataLab</h4>
          </div>
          <p class="text-gray-400 mb-4">Unified enterprise platform for HR, Payroll, Projects, Inventory, Fleet, and HSE.</p>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-linkedin"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="text-gray-400 hover:text-white transition">
              <i class="fab fa-facebook"></i>
            </a>
          </div>
        </div>
        <div>
          <h5 class="text-lg font-semibold mb-4">Solutions</h5>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Core ERP</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Projects & Milestones</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">HR & Payroll</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Inventory & Warehousing</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Fleet & Logistics</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">HSE & Compliance</a></li>
          </ul>
        </div>
        <div>
          <h5 class="text-lg font-semibold mb-4">Resources</h5>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Blog</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Webinars</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Documentation</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Case Studies</a></li>
          </ul>
        </div>
        <div>
          <h5 class="text-lg font-semibold mb-4">Legal</h5>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Terms of Service</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Privacy Policy</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Legal Notice</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Cookies</a></li>
          </ul>
        </div>
      </div>
      <div class="pt-8 mt-8 border-t border-gray-800 text-center text-gray-400">
        <p>&copy; 2025 Dreamex DataLab. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Back to Top Button -->
  <button id="backToTopBtn" class="back-to-top bg-primary-600 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg">
    <i class="fas fa-arrow-up"></i>
  </button>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  
  <script>
    (function(){
      // Initialize EmailJS with your public key
      emailjs.init('fHs6oaqQgkcPoUwpv'); // EmailJS public key from staff.html
      
      const form = document.getElementById('contactForm');
      if (!form) return;
      const statusEl = document.getElementById('contactStatus');
      const submitBtn = document.getElementById('contactSubmitBtn');

      function setStatus(msg, type){
        if (!statusEl) return;
        statusEl.textContent = msg;
        statusEl.className = 'mt-3 text-sm ' + (type === 'error' ? 'text-red-600' : 'text-green-600');
      }

      form.addEventListener('submit', async function(e){
        e.preventDefault();
        setStatus('', '');
        if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Sending...'; }

        const name = (document.getElementById('name')||{}).value?.trim() || '';
        const email = (document.getElementById('email')||{}).value?.trim() || '';
        const company = (document.getElementById('company')||{}).value?.trim() || '';
        const message = (document.getElementById('message')||{}).value?.trim() || '';

        if (!name || !email || !message) {
          setStatus('Please fill in your name, email, and message.', 'error');
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Submit Request'; }
          return;
        }

        try {
          // Send email using EmailJS
          const templateParams = {
            from_name: name,
            from_email: email,
            company: company,
            message: message,
            to_email: 'info@dreamexdatalab.com'
          };

          const result = await emailjs.send(
            'service_p2e9swy',    // EmailJS service ID from staff.html
            'template_l50h8ks',   // Using same template as staff.html (you may want to create a contact-specific template)
            templateParams
          );

          if (result.status === 200) {
            setStatus('Thank you! Your request has been sent. We will get back to you shortly.', 'success');
            form.reset();
          } else {
            throw new Error('Failed to send message');
          }
        } catch (err) {
          console.error('EmailJS error:', err);
          setStatus('Unable to send your request. Please try again later.', 'error');
          // Fallback: open the user’s mail client
          const subject = encodeURIComponent('New Demo Request');
          const bodyLines = [
            `Name: ${name}`,
            `Email: ${email}`,
            `Company: ${company}`,
            '',
            'Message:',
            message
          ];
          const mailtoUrl = `mailto:info@dreamexdatalab.com?subject=${subject}&body=${encodeURIComponent(bodyLines.join('\r\n'))}`;
          try { window.location.href = mailtoUrl; } catch(_) {}
        } finally {
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Submit Request'; }
        }
      });
    })();
  </script>

  <!-- Login Modal -->
  <div class="login-modal-overlay" id="loginModal">
    <div class="login-modal">
      <button class="modal-close" id="closeLoginModal">
        <i class="fas fa-times"></i>
      </button>
      
      <!-- Left side with company branding -->
      <div class="login-modal-left">
        <div class="content">
          <div class="mb-6">
            <i class="fas fa-chart-line text-6xl mb-4"></i>
            <h2 class="text-3xl font-bold mb-2">Dreamex DataLab</h2>
            <p class="text-lg opacity-90">HSE Management System</p>
          </div>
          
          <div class="space-y-4 text-left">
            <div class="flex items-center">
              <i class="fas fa-shield-alt text-yellow-300 mr-3"></i>
              <span>Secure & Compliant</span>
            </div>
            <div class="flex items-center">
              <i class="fas fa-chart-bar text-yellow-300 mr-3"></i>
              <span>Real-time Analytics</span>
            </div>
            <div class="flex items-center">
              <i class="fas fa-cloud text-yellow-300 mr-3"></i>
              <span>Cloud-based Platform</span>
            </div>
            <div class="flex items-center">
              <i class="fas fa-users text-yellow-300 mr-3"></i>
              <span>Team Collaboration</span>
            </div>
          </div>
          
          <div class="mt-8 p-4 bg-white/10 rounded-lg backdrop-blur-sm">
            <p class="text-sm">
              <i class="fas fa-info-circle mr-2"></i>
              Access your HSE dashboard with enterprise-grade security
            </p>
          </div>
        </div>
      </div>
      
      <!-- Right side with login form -->
      <div class="login-modal-right">
        <div class="login-form-container">
          <h2 style="text-align: center; margin-bottom: 18px; color: #334155; font-size: 1.4rem;">Sign in to your account</h2>
          
          <div id="error-message"></div>
          
          <form class="login-form" id="login-form">
            <div class="form-group">
              <label for="modal-email">Email Address</label>
              <div class="form-input-container has-icon">
                <i class="fas fa-envelope form-input-icon"></i>
                <input type="email" id="modal-email" required autocomplete="email" placeholder="your.email@company.com">
              </div>
            </div>
            
            <div class="form-group">
              <label for="modal-password">Password</label>
              <div class="password-field">
                <div class="form-input-container has-icon">
                  <i class="fas fa-lock form-input-icon"></i>
                  <input type="password" id="modal-password" required autocomplete="current-password" placeholder="••••••••">
                  <i class="fas fa-eye toggle-password" id="togglePassword"></i>
                </div>
              </div>
            </div>
            
            <div class="remember-me">
              <input type="checkbox" id="modal-remember-me">
              <label for="modal-remember-me">Remember me</label>
            </div>
            
            <button type="submit" class="btn-login">
              <div class="loading-spinner" id="login-spinner"></div>
              <span>Sign In</span>
            </button>
          </form>
          
          <div class="login-options">
            <a href="#" id="forgot-password">Forgot Password?</a>
          </div>
          
          <div class="login-options">
            <p>Don't have an account? <a href="#" id="request-access">Request Access</a></p>
          </div>
        </div>
      </div>
    </div>
  </div>

    <!-- Self-contained login system - no external dependencies -->
  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCUTmTn0rRBb0M-UkQJxnUMrWqXYU_BgIc",
      authDomain: "users-8be65.firebaseapp.com",
      databaseURL: "https://users-8be65-default-rtdb.firebaseio.com",
      projectId: "users-8be65",
      storageBucket: "users-8be65.firebasestorage.app",
      messagingSenderId: "829083030831",
      appId: "1:829083030831:web:36a370e62691e560bc3dda"
    };

    // Initialize Firebase when page loads
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof window.firebase !== 'undefined' && (!window.firebase.apps || window.firebase.apps.length === 0)) {
        try {
          window.firebase.initializeApp(firebaseConfig);
          console.log('✅ Firebase initialized successfully');
        } catch (error) {
          console.error('❌ Firebase initialization failed:', error);
        }
      }
    });

    // Self-contained login function
    window.handleDomainLogin = async function(email, password) {
      // Wait for Firebase to be available
      let retryCount = 0;
      while (typeof window.firebase === 'undefined' && retryCount < 50) {
        await new Promise(resolve => setTimeout(resolve, 100));
        retryCount++;
      }
      
      if (typeof window.firebase === 'undefined') {
        throw new Error('Login system not available. Please refresh the page and try again.');
      }
      
      // Initialize Firebase if not already done
      if (!window.firebase.apps || window.firebase.apps.length === 0) {
        window.firebase.initializeApp(firebaseConfig);
      }
      
      const auth = window.firebase.auth();
      const database = window.firebase.database();
      
      // Sign in with Firebase
      console.log('🔥 Attempting Firebase sign in...');
      const userCredential = await auth.signInWithEmailAndPassword(email, password);
      const userData = userCredential.user;
      
      console.log('✅ Firebase sign in successful:', userData.uid);
      
      // Search for user in company structures
      const companiesRef = database.ref('companies');
      const companiesSnapshot = await companiesRef.once('value');
      
      let userInfo = null;
      let companyData = null;
      
      if (companiesSnapshot.exists()) {
        const companies = companiesSnapshot.val();
        let foundUser = null;
        let foundCompanyId = null;
        
        // Search through all companies for a user with matching authUid
        for (const [companyId, company] of Object.entries(companies)) {
          // Check company status first
          if (company.status !== 'active') {
            continue; // Skip inactive companies
          }
          
          // Check in company users
          if (company.users) {
            for (const [userId, user] of Object.entries(company.users)) {
              if (user.authUid === userData.uid || userId === userData.uid) {
                foundUser = user;
                foundCompanyId = companyId;
                companyData = company;
                break;
              }
            }
          }
          
          // Also check in admin section for company admins
          if (!foundUser && company.admin && (company.admin.authUid === userData.uid || company.admin.userId === userData.uid)) {
            foundUser = company.admin;
            foundCompanyId = companyId;
            companyData = company;
          }
          
          if (foundUser) break;
        }
        
        if (foundUser) {
          // Create userInfo from company user data
          userInfo = {
            uid: userData.uid,
            email: foundUser.email,
            name: foundUser.name || foundUser.adminName,
            role: foundUser.role,
            department: foundUser.department,
            companyId: foundCompanyId,
            requiresPasswordChange: foundUser.requiresPasswordChange,
            isFirstLogin: foundUser.isFirstLogin,
            isCompanyAdmin: foundUser.isCompanyAdmin
          };
          companyData = companies[foundCompanyId];
          console.log('✅ User found in company scope:', foundCompanyId);
        } else {
          throw new Error('Your account is not associated with any company. Please contact your administrator.');
        }
      } else {
        throw new Error('No companies found. Please contact support.');
      }
      
      // Verify company is active  
      if (companyData.status !== 'active') {
        throw new Error('Your company account is inactive. Please contact support.');
      }
      
      // Check if this is the user's first login and requires password change
      if (userInfo.requiresPasswordChange || userInfo.isFirstLogin) {
        throw new Error('First login detected. Please use the main login page to complete account setup.');
      }
      
      // Update user data with company info
      userData.companyId = userInfo.companyId;
      userData.companyName = companyData.companyName;
      userData.role = userInfo.role;
      userData.department = userInfo.department;
      userData.name = userInfo.name;
      
      // Store user info in both keys for compatibility
      const userDataToStore = {
        uid: userData.uid,
        email: userData.email,
        name: userData.name,
        role: userData.role,
        companyId: userData.companyId,
        companyName: userData.companyName,
        department: userData.department,
        lastLogin: new Date().toISOString()
      };
      
      localStorage.setItem('user', JSON.stringify(userDataToStore));
      localStorage.setItem('currentUser', JSON.stringify(userDataToStore));
      
      // Update user display immediately
      if (window.updateAllUserDisplayElements) {
        window.updateAllUserDisplayElements();
      }
      
      // Show success message
      if (window.showSuccessMessage) {
        window.showSuccessMessage('Welcome back, ' + userData.name + '!');
      }
      
      // Redirect to dashboard page
      setTimeout(() => {
        window.location.href = 'dashboard.html';
      }, 1500);
    };
    
    // Global functions for login modal
    window.loginModalFunctions = {
      openModal: function() {
        document.getElementById('loginModal').classList.add('active');
        document.body.style.overflow = 'hidden';
      },
      
      closeModal: function() {
        document.getElementById('loginModal').classList.remove('active');
        document.body.style.overflow = 'auto';
      },
      
      handleLogin: async function(email, password) {
        const spinner = document.getElementById('login-spinner');
        const errorMessage = document.getElementById('error-message');
        
        try {
          spinner.style.display = 'block';
          errorMessage.style.display = 'none';
          
          // Use the self-contained login system
          console.log('🔄 Using self-contained login system...');
          await window.handleDomainLogin(email, password);
          
          // Close modal on successful login
          this.closeModal();
          
        } catch (error) {
          console.error('Login error:', error);
          
          // Show error message
          errorMessage.textContent = error.message || 'An error occurred during login. Please try again.';
          errorMessage.style.display = 'block';
          
        } finally {
          spinner.style.display = 'none';
        }
      }
    };
  </script>

  <script>
    // Login Modal Management
    const loginModal = document.getElementById('loginModal');
    const loginButton = document.getElementById('loginButton');
    const mobileLoginBtn = document.getElementById('mobileLoginBtn');
    const closeLoginModal = document.getElementById('closeLoginModal');
    const loginForm = document.getElementById('login-form');
    const togglePassword = document.getElementById('togglePassword');
    
    // Open login modal
    function openLoginModal() {
      loginModal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    
    // Close login modal
    function closeLoginModalFunc() {
      loginModal.classList.remove('active');
      document.body.style.overflow = 'auto';
    }
    
    // Event listeners for login buttons
    loginButton.addEventListener('click', openLoginModal);
    if (mobileLoginBtn) mobileLoginBtn.addEventListener('click', openLoginModal);
    closeLoginModal.addEventListener('click', closeLoginModalFunc);
    
    // Close modal when clicking outside
    loginModal.addEventListener('click', function(e) {
      if (e.target === loginModal) {
        closeLoginModalFunc();
      }
    });
    
    // Close modal with Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && loginModal.classList.contains('active')) {
        closeLoginModalFunc();
      }
    });
    
    // Password toggle functionality
    togglePassword.addEventListener('click', function() {
      const passwordInput = document.getElementById('modal-password');
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      
      // Toggle eye icon
      this.classList.toggle('fa-eye');
      this.classList.toggle('fa-eye-slash');
    });
    
    // Handle login form submission
    loginForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = document.getElementById('modal-email').value;
      const password = document.getElementById('modal-password').value;
      
      // Basic validation
      if (!email || !password) {
        showError('Please fill in all fields.');
        return;
      }
      
      // Use the self-contained login system
      await window.loginModalFunctions.handleLogin(email, password);
    });
    
    // Utility functions
    function showError(message) {
      const errorDiv = document.getElementById('error-message');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      
      // Shake animation
      loginForm.style.animation = 'shake 0.5s ease-in-out';
      setTimeout(() => {
        loginForm.style.animation = '';
      }, 500);
    }
    
    function showSuccessMessage(message) {
      // Create and show success notification
      const notification = document.createElement('div');
      notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
      notification.innerHTML = `
        <div class="flex items-center">
          <i class="fas fa-check-circle mr-2"></i>
          <span>${message}</span>
        </div>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }
    
    // Make showSuccessMessage available globally
    window.showSuccessMessage = showSuccessMessage;
    
    // User login status check
    function checkLoginStatus() {
      // Check both localStorage and sessionStorage
      const user = JSON.parse(localStorage.getItem('user')) || JSON.parse(sessionStorage.getItem('user'));
      
      const mobileUserAvatar = document.getElementById('mobileUserAvatar');
      const mobileAvatarCircle = document.getElementById('mobileAvatarCircle');
      const mobileLoginBtn = document.getElementById('mobileLoginBtn');
      const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
      
      if (user) {
        // User is logged in, show username and logout button
        document.getElementById('username').textContent = user.name;
        
        document.getElementById('userStatus').classList.remove('hidden');
        document.getElementById('userStatus').classList.add('flex');
        document.getElementById('loginButton').classList.add('hidden');
        document.getElementById('logoutButton').classList.remove('hidden');
        
        // Mobile: Show avatar with initials and logout button
        if (mobileUserAvatar && mobileAvatarCircle) {
          const initials = user.name ? user.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) : 'U';
          mobileAvatarCircle.textContent = initials;
          mobileUserAvatar.classList.remove('hidden');
        }
        if (mobileLoginBtn) mobileLoginBtn.classList.add('hidden');
        if (mobileLogoutBtn) mobileLogoutBtn.classList.remove('hidden');
      } else {
        // User is not logged in, show login button
        document.getElementById('userStatus').classList.add('hidden');
        document.getElementById('userStatus').classList.remove('flex');
        document.getElementById('loginButton').classList.remove('hidden');
        document.getElementById('logoutButton').classList.add('hidden');
        
        // Mobile: Hide avatar and show login button
        if (mobileUserAvatar) mobileUserAvatar.classList.add('hidden');
        if (mobileLoginBtn) mobileLoginBtn.classList.remove('hidden');
        if (mobileLogoutBtn) mobileLogoutBtn.classList.add('hidden');
      }
    }
    
    // Handle logout
    function handleLogout() {
      localStorage.removeItem('user');
      localStorage.removeItem('currentUser');
      sessionStorage.removeItem('user');
      sessionStorage.removeItem('currentUser');
      checkLoginStatus();
      showSuccessMessage('You have been logged out successfully.');
      
      // Also logout from Firebase
      if (window.firebase && window.firebase.auth) {
        window.firebase.auth().signOut().catch(console.error);
      }
    }
    
    // Set up logout button listeners
    document.getElementById('logoutButton').addEventListener('click', handleLogout);
    const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
    if (mobileLogoutBtn) mobileLogoutBtn.addEventListener('click', handleLogout);
    
    // Check login status when page loads
    document.addEventListener('DOMContentLoaded', checkLoginStatus);
    
    // Mobile Sidebar Toggle (for app view)
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuToggle = document.getElementById('mobileMenuToggle');
      const appSidebar = document.getElementById('appSidebar');
      const backdrop = document.getElementById('mobileSidebarBackdrop');
      const sidebarLogout = document.getElementById('sidebarLogout');
      
      if (!mobileMenuToggle || !appSidebar || !backdrop) return;
      
      function closeMobileMenu() {
        appSidebar.classList.remove('mobile-active');
        backdrop.classList.remove('active');
        document.body.style.overflow = '';
      }
      
      // Open mobile menu
      mobileMenuToggle.addEventListener('click', function() {
        appSidebar.classList.add('mobile-active');
        backdrop.classList.add('active');
        document.body.style.overflow = 'hidden';
      });
      
      // Close mobile menu when clicking backdrop
      backdrop.addEventListener('click', function() {
        closeMobileMenu();
      });
      
      // Close mobile menu when clicking links
      const menuLinks = appSidebar.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          if (link.id === 'sidebarLogout') {
            e.preventDefault();
            handleLogout();
          }
          closeMobileMenu();
        });
      });
      
      // Close mobile menu on escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && appSidebar.classList.contains('mobile-active')) {
          closeMobileMenu();
        }
      });
    });
  </script>
  <script src="js/user-display.js"></script>

  <!-- Platform Features Loading Script -->
  <script>
    // Features Management for Index Page
    let platformFeatures = [];

    // Load platform features from Firebase
    async function loadPlatformFeatures() {
      try {
        // Show loading state
        document.getElementById('featuresLoadingState').style.display = 'block';
        document.getElementById('featuresGrid').style.display = 'none';
        document.getElementById('featuresEmptyState').style.display = 'none';

        if (typeof firebase === 'undefined' || !firebase.database) {
          console.warn('Firebase database not available, using fallback features');
          showFallbackFeatures();
          return;
        }

        const database = firebase.database();
        const featuresRef = database.ref('platformFeatures');
        
        const snapshot = await featuresRef.once('value');
        const featuresData = snapshot.val();

        if (featuresData) {
          // Convert Firebase object to array and filter active features
          platformFeatures = Object.keys(featuresData)
            .map(key => ({ id: key, ...featuresData[key] }))
            .filter(feature => feature.status === 'active' || !feature.status);
          
          if (platformFeatures.length > 0) {
            displayPlatformFeatures();
          } else {
            showFeaturesEmptyState();
          }
        } else {
          console.warn('No platform features found in Firebase, using fallback');
          showFallbackFeatures();
        }
      } catch (error) {
        console.error('Error loading platform features:', error);
        showFallbackFeatures();
      }
    }

    // Display platform features in the grid
    function displayPlatformFeatures() {
      const featuresGrid = document.getElementById('featuresGrid');
      const loadingState = document.getElementById('featuresLoadingState');
      const emptyState = document.getElementById('featuresEmptyState');

      // Hide loading and empty states
      loadingState.style.display = 'none';
      emptyState.style.display = 'none';

      // Generate feature cards HTML
      const featuresHTML = platformFeatures.map(feature => createFeatureCard(feature)).join('');
      featuresGrid.innerHTML = featuresHTML;
      
      // Show the grid
      featuresGrid.style.display = 'grid';
    }

    // Create individual feature card HTML
    function createFeatureCard(feature) {
      const price = parseFloat(feature.price || 0);
      const priceDisplay = price > 0 ? `$${price.toFixed(2)}/user/month` : 'Included';
      const iconClass = feature.icon || 'fas fa-puzzle-piece';

      return `
        <div class="bg-white p-8 rounded-xl shadow-md feature-card transition duration-300">
          <div class="text-primary-500 mb-4 flex items-center justify-start">
            <i class="${iconClass} text-4xl mr-3"></i>
          </div>
          <h4 class="text-xl font-semibold mb-3">${feature.name || 'Unknown Feature'}</h4>
          <p class="text-gray-600 mb-4">${feature.description || 'Feature description not available'}</p>
          <div class="text-sm text-primary-600 font-medium">
            ${priceDisplay}
          </div>
          ${feature.category ? `<div class="mt-2 text-xs text-gray-500 uppercase tracking-wide">${feature.category}</div>` : ''}
        </div>
      `;
    }

    // Show empty state when no features are available
    function showFeaturesEmptyState() {
      document.getElementById('featuresLoadingState').style.display = 'none';
      document.getElementById('featuresGrid').style.display = 'none';
      document.getElementById('featuresEmptyState').style.display = 'block';
    }

    // Fallback features in case Firebase is not available
    function showFallbackFeatures() {
      const fallbackFeatures = [
        {
          id: 'erp-core',
          name: 'Core ERP',
          description: 'Unified business backbone for finance, procurement, inventory, and approvals',
          icon: 'fas fa-network-wired',
          category: 'Operations',
          price: 0,
          status: 'active'
        },
        {
          id: 'projects',
          name: 'Projects & Tasks',
          description: 'Plan, assign, and track projects with milestones, Gantt charts, and dashboards',
          icon: 'fas fa-project-diagram',
          category: 'Projects',
          price: 0,
          status: 'active'
        },
        {
          id: 'hr-fallback',
          name: 'Human Capital',
          description: 'HR management, recruitment, training, and employee development',
          icon: 'fas fa-users',
          category: 'HR',
          price: 0,
          status: 'active'
        },
        {
          id: 'payroll',
          name: 'Payroll',
          description: 'Automated payroll runs, pay elements, payslips, and compliance',
          icon: 'fas fa-file-invoice-dollar',
          category: 'Finance',
          price: 0,
          status: 'active'
        },
        {
          id: 'logistics-fallback',
          name: 'Logistics',
          description: 'Supply chain, inventory, warehouses, and fleet management',
          icon: 'fas fa-truck',
          category: 'Logistics',
          price: 0,
          status: 'active'
        },
        {
          id: 'hse-fallback',
          name: 'HSE Management',
          description: 'Incident tracking, risk assessments, and safety audits',
          icon: 'fas fa-shield-alt',
          category: 'Safety',
          price: 0,
          status: 'active'
        }
      ];

      platformFeatures = fallbackFeatures;
      displayPlatformFeatures();
    }

    // Initialize features loading when the page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Wait a bit for Firebase to initialize if it's loading
      setTimeout(() => {
        loadPlatformFeatures();
      }, 1000);
    });

    // Refresh features every 5 minutes to catch updates
    setInterval(() => {
      loadPlatformFeatures();
    }, 5 * 60 * 1000);
  </script>

<script>
// GitHub Pages compatibility fixes
window.addEventListener('error', function(e) {
  if (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK') {
    console.warn('Resource loading issue:', e.target.src || e.target.href);
  }
});

// Fallback for missing CSS
document.addEventListener('DOMContentLoaded', function() {
  // Check if Tailwind is loaded
  const testDiv = document.createElement('div');
  testDiv.className = 'hidden';
  document.body.appendChild(testDiv);
  const isHidden = window.getComputedStyle(testDiv).display === 'none';
  document.body.removeChild(testDiv);
  if (!isHidden) console.warn('Tailwind CSS may not be loaded properly');
});
</script>
</body>
</html>
