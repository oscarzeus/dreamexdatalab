<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMTP & Email Diagnostic Tool - Dreamex Datalab</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2rem;
            font-weight: 600;
        }
        
        .header p {
            margin: 0.5rem 0 0 0;
            opacity: 0.9;
        }
        
        .content {
            padding: 2rem;
        }
        
        .diagnostic-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid #667eea;
        }
        
        .diagnostic-section h3 {
            margin-top: 0;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        
        .btn:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .status-display {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
            min-height: 60px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 300px;
        }
        
        .test-form {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #495057;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }
        
        .status-good {
            color: #28a745;
            font-weight: 600;
        }
        
        .status-warning {
            color: #ffc107;
            font-weight: 600;
        }
        
        .status-error {
            color: #dc3545;
            font-weight: 600;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .config-display {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .config-section {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #dee2e6;
        }
        
        .config-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .email-logs {
            max-height: 400px;
            overflow-y: auto;
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #667eea;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß SMTP & Email Diagnostic Tool</h1>
            <p>Comprehensive email service diagnostics for Dreamex Datalab HSE System</p>
        </div>
        
        <div class="content">
            <!-- Service Status Section -->
            <div class="diagnostic-section">
                <h3>üöÄ Service Status</h3>
                <button class="btn" onclick="checkServiceStatus()">Check Email Service Status</button>
                <button class="btn btn-success" onclick="checkSMTPConnection()">Test SMTP Connection</button>
                <button class="btn btn-warning" onclick="checkEmailJSStatus()">Test EmailJS Status</button>
                <div id="serviceStatus" class="status-display">Click a button above to check service status...</div>
            </div>

            <!-- Configuration Review Section -->
            <div class="diagnostic-section">
                <h3>‚öôÔ∏è Configuration Review</h3>
                <button class="btn" onclick="reviewEmailConfig()">Review Email Configuration</button>
                <button class="btn" onclick="checkEnvironmentVars()">Check Environment Variables</button>
                <div id="configStatus" class="status-display">Click a button above to review configuration...</div>
            </div>

            <!-- Email Testing Section -->
            <div class="diagnostic-section">
                <h3>üìß Email Testing</h3>
                <div class="test-form">
                    <div class="form-group">
                        <label for="testEmail">Test Email Address:</label>
                        <input type="email" class="form-control" id="testEmail" placeholder="your-email@example.com" value="info@dreamexdatalab.com">
                    </div>
                    <div class="form-group">
                        <label for="testSubject">Subject:</label>
                        <input type="text" class="form-control" id="testSubject" value="SMTP Test - Dreamex Datalab">
                    </div>
                    <div class="form-group">
                        <label for="testMessage">Message:</label>
                        <textarea class="form-control" id="testMessage" rows="4" placeholder="Test message content...">This is a test email from the Dreamex Datalab SMTP diagnostic tool to verify email delivery functionality.</textarea>
                    </div>
                    <button class="btn btn-success" onclick="sendTestEmail()">Send SMTP Test Email</button>
                    <button class="btn btn-warning" onclick="sendEmailJSTest()">Send EmailJS Test Email</button>
                    <button class="btn" onclick="testStaffNotification()">Test Staff Notification Email</button>
                </div>
                <div id="testResults" class="status-display">Ready to send test emails...</div>
            </div>

            <!-- EmailJS Configuration Section -->
            <div class="diagnostic-section">
                <h3>üì¨ EmailJS Configuration</h3>
                <button class="btn" onclick="checkEmailJSConfig()">Check EmailJS Configuration</button>
                <button class="btn btn-warning" onclick="validateEmailJSTemplate()">Validate Template</button>
                <div id="emailjsStatus" class="status-display">Click a button above to check EmailJS configuration...</div>
            </div>

            <!-- Network & Firewall Section -->
            <div class="diagnostic-section">
                <h3>üîí Network & Security</h3>
                <button class="btn" onclick="checkNetworkConnectivity()">Check Network Connectivity</button>
                <button class="btn" onclick="checkFirewallPorts()">Check Firewall Ports</button>
                <button class="btn btn-danger" onclick="checkDNSResolution()">Check DNS Resolution</button>
                <div id="networkStatus" class="status-display">Click a button above to check network connectivity...</div>
            </div>

            <!-- Email Logs Section -->
            <div class="diagnostic-section">
                <h3>üìã Email Service Logs</h3>
                <button class="btn" onclick="fetchEmailLogs()">Fetch Recent Logs</button>
                <button class="btn btn-warning" onclick="clearEmailLogs()">Clear Logs</button>
                <div id="emailLogs" class="email-logs">Email logs will appear here...</div>
            </div>
        </div>
    </div>

    <script>
        // Global configuration
        const CONFIG = {
            emailServiceUrl: 'http://localhost:3001',
            emailJSPublicKey: 'fHs6oaqQgkcPoUwpv',
            emailJSServiceId: 'service_p2e9swy',
            emailJSTemplateId: 'template_l50h8ks'
        };

        // Utility functions
        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status-display status-${type}`;
        }

        function appendStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            element.textContent += `[${timestamp}] ${message}\n`;
            element.scrollTop = element.scrollHeight;
        }

        // Service Status Functions
        async function checkServiceStatus() {
            updateStatus('serviceStatus', 'Checking email service status...', 'warning');
            
            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/health`);
                if (response.ok) {
                    const data = await response.json();
                    updateStatus('serviceStatus', `‚úÖ Email service is running!\nStatus: ${JSON.stringify(data, null, 2)}`, 'good');
                } else {
                    updateStatus('serviceStatus', `‚ùå Email service returned status: ${response.status}`, 'error');
                }
            } catch (error) {
                updateStatus('serviceStatus', `‚ùå Failed to connect to email service: ${error.message}\n\nPlease ensure the email service is running:\n1. Open PowerShell as Administrator\n2. Run: cd "c:\\Users\\Dreamex Lab\\dreamexdatalab\\email-service"\n3. Run: npm start`, 'error');
            }
        }

        async function checkSMTPConnection() {
            updateStatus('serviceStatus', 'Testing SMTP connection...', 'warning');
            
            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/smtp-test`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });
                
                const result = await response.json();
                if (result.success) {
                    updateStatus('serviceStatus', `‚úÖ SMTP connection successful!\nDetails: ${JSON.stringify(result, null, 2)}`, 'good');
                } else {
                    updateStatus('serviceStatus', `‚ùå SMTP connection failed: ${result.error}`, 'error');
                }
            } catch (error) {
                updateStatus('serviceStatus', `‚ùå SMTP test failed: ${error.message}`, 'error');
            }
        }

        async function checkEmailJSStatus() {
            updateStatus('serviceStatus', 'Testing EmailJS connection...', 'warning');
            
            if (typeof emailjs === 'undefined') {
                updateStatus('serviceStatus', '‚ùå EmailJS library not loaded. Please check if EmailJS CDN is accessible.', 'error');
                return;
            }

            try {
                // Initialize EmailJS
                emailjs.init(CONFIG.emailJSPublicKey);
                
                // Try to send a test email
                const templateParams = {
                    to_email: 'test@dreamexdatalab.com',
                    to_name: 'Test User',
                    from_name: 'Diagnostic Tool',
                    subject: 'EmailJS Test',
                    message: 'This is a test from the diagnostic tool'
                };

                const response = await emailjs.send(
                    CONFIG.emailJSServiceId,
                    CONFIG.emailJSTemplateId,
                    templateParams
                );

                updateStatus('serviceStatus', `‚úÖ EmailJS connection successful!\nResponse: ${JSON.stringify(response, null, 2)}`, 'good');
            } catch (error) {
                updateStatus('serviceStatus', `‚ùå EmailJS test failed: ${error.text || error.message || error}`, 'error');
            }
        }

        // Configuration Review Functions
        async function reviewEmailConfig() {
            updateStatus('configStatus', 'Reviewing email configuration...', 'warning');
            
            const config = {
                'Email Service URL': CONFIG.emailServiceUrl,
                'EmailJS Public Key': CONFIG.emailJSPublicKey ? `${CONFIG.emailJSPublicKey.substring(0, 10)}...` : 'Not set',
                'EmailJS Service ID': CONFIG.emailJSServiceId || 'Not set',
                'EmailJS Template ID': CONFIG.emailJSTemplateId || 'Not set',
                'Current Domain': window.location.origin,
                'User Agent': navigator.userAgent.substring(0, 50) + '...'
            };

            let configText = 'Current Email Configuration:\n';
            for (const [key, value] of Object.entries(config)) {
                configText += `${key}: ${value}\n`;
            }

            updateStatus('configStatus', configText, 'info');
        }

        async function checkEnvironmentVars() {
            updateStatus('configStatus', 'Checking environment variables...', 'warning');
            
            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/config`);
                if (response.ok) {
                    const data = await response.json();
                    updateStatus('configStatus', `Environment Configuration:\n${JSON.stringify(data, null, 2)}`, 'good');
                } else {
                    updateStatus('configStatus', `‚ùå Failed to fetch environment config: ${response.status}`, 'error');
                }
            } catch (error) {
                updateStatus('configStatus', `‚ùå Error checking environment: ${error.message}`, 'error');
            }
        }

        // Email Testing Functions
        async function sendTestEmail() {
            const email = document.getElementById('testEmail').value;
            const subject = document.getElementById('testSubject').value;
            const message = document.getElementById('testMessage').value;

            if (!email) {
                updateStatus('testResults', '‚ùå Please enter a test email address', 'error');
                return;
            }

            updateStatus('testResults', 'Sending SMTP test email...', 'warning');

            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/send-test-email`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        to: email,
                        subject: subject,
                        text: message,
                        html: `<p>${message}</p>`
                    })
                });

                const result = await response.json();
                if (result.success) {
                    updateStatus('testResults', `‚úÖ SMTP test email sent successfully!\nMessage ID: ${result.messageId}\nRecipient: ${email}`, 'good');
                } else {
                    updateStatus('testResults', `‚ùå SMTP test email failed: ${result.error}`, 'error');
                }
            } catch (error) {
                updateStatus('testResults', `‚ùå SMTP test failed: ${error.message}`, 'error');
            }
        }

        async function sendEmailJSTest() {
            const email = document.getElementById('testEmail').value;
            const subject = document.getElementById('testSubject').value;
            const message = document.getElementById('testMessage').value;

            if (!email) {
                updateStatus('testResults', '‚ùå Please enter a test email address', 'error');
                return;
            }

            updateStatus('testResults', 'Sending EmailJS test email...', 'warning');

            if (typeof emailjs === 'undefined') {
                updateStatus('testResults', '‚ùå EmailJS library not loaded', 'error');
                return;
            }

            try {
                emailjs.init(CONFIG.emailJSPublicKey);
                
                const templateParams = {
                    to_email: email,
                    to_name: 'Test User',
                    from_name: 'Diagnostic Tool',
                    subject: subject,
                    message: message
                };

                const response = await emailjs.send(
                    CONFIG.emailJSServiceId,
                    CONFIG.emailJSTemplateId,
                    templateParams
                );

                updateStatus('testResults', `‚úÖ EmailJS test email sent successfully!\nResponse: ${JSON.stringify(response, null, 2)}`, 'good');
            } catch (error) {
                updateStatus('testResults', `‚ùå EmailJS test failed: ${error.text || error.message || error}`, 'error');
            }
        }

        async function testStaffNotification() {
            const email = document.getElementById('testEmail').value;
            
            if (!email) {
                updateStatus('testResults', '‚ùå Please enter a test email address', 'error');
                return;
            }

            updateStatus('testResults', 'Testing staff notification email...', 'warning');

            // Simulate a position approval request
            const positionData = {
                approverEmail: email,
                approverName: 'Test Approver',
                positionTitle: 'Test Position',
                department: 'IT',
                requestingManager: 'Test Manager',
                requestDate: new Date().toISOString(),
                positionId: 'TEST-001',
                employmentType: 'full-time',
                workLocation: 'Office',
                salaryMin: 50000,
                salaryMax: 70000
            };

            if (typeof emailjs === 'undefined') {
                updateStatus('testResults', '‚ùå EmailJS library not loaded for staff notification test', 'error');
                return;
            }

            try {
                emailjs.init(CONFIG.emailJSPublicKey);
                
                const emailParams = {
                    to_email: positionData.approverEmail,
                    to_name: positionData.approverName,
                    from_name: 'Dreamex Datalab HSE System',
                    subject: `Position Approval Required: ${positionData.positionTitle}`,
                    position_id: positionData.positionId,
                    position_title: positionData.positionTitle,
                    department: positionData.department,
                    requesting_manager: positionData.requestingManager,
                    company_name: 'Dreamex Datalab'
                };

                const response = await emailjs.send(
                    CONFIG.emailJSServiceId,
                    CONFIG.emailJSTemplateId,
                    emailParams
                );

                updateStatus('testResults', `‚úÖ Staff notification test email sent successfully!\nResponse: ${JSON.stringify(response, null, 2)}`, 'good');
            } catch (error) {
                updateStatus('testResults', `‚ùå Staff notification test failed: ${error.text || error.message || error}`, 'error');
            }
        }

        // EmailJS Configuration Functions
        async function checkEmailJSConfig() {
            updateStatus('emailjsStatus', 'Checking EmailJS configuration...', 'warning');
            
            let configReport = 'EmailJS Configuration Report:\n\n';
            
            // Check if EmailJS is loaded
            if (typeof emailjs === 'undefined') {
                configReport += '‚ùå EmailJS library not loaded\n';
                configReport += '   Solution: Add EmailJS CDN to your HTML:\n';
                configReport += '   <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"><\/script>\n\n';
            } else {
                configReport += '‚úÖ EmailJS library loaded\n\n';
            }

            // Check configuration values
            configReport += `Public Key: ${CONFIG.emailJSPublicKey ? '‚úÖ Set' : '‚ùå Missing'}\n`;
            configReport += `Service ID: ${CONFIG.emailJSServiceId ? '‚úÖ Set' : '‚ùå Missing'}\n`;
            configReport += `Template ID: ${CONFIG.emailJSTemplateId ? '‚úÖ Set' : '‚ùå Missing'}\n\n`;

            // Check network connectivity to EmailJS
            try {
                const response = await fetch('https://api.emailjs.com/api/v1.0/email/send', {
                    method: 'OPTIONS'
                });
                configReport += '‚úÖ EmailJS API is accessible\n';
            } catch (error) {
                configReport += '‚ùå EmailJS API not accessible\n';
                configReport += `   Error: ${error.message}\n`;
            }

            updateStatus('emailjsStatus', configReport, 'info');
        }

        async function validateEmailJSTemplate() {
            updateStatus('emailjsStatus', 'Validating EmailJS template...', 'warning');
            
            if (typeof emailjs === 'undefined') {
                updateStatus('emailjsStatus', '‚ùå EmailJS library not loaded', 'error');
                return;
            }

            try {
                emailjs.init(CONFIG.emailJSPublicKey);
                
                // Send a minimal test to validate template
                const testParams = {
                    to_email: 'validation@test.com',
                    to_name: 'Validation Test',
                    from_name: 'Template Validator',
                    subject: 'Template Validation Test'
                };

                // This will fail with invalid email but will validate template structure
                try {
                    await emailjs.send(CONFIG.emailJSServiceId, CONFIG.emailJSTemplateId, testParams);
                    updateStatus('emailjsStatus', '‚úÖ Template validation successful!', 'good');
                } catch (error) {
                    if (error.text && error.text.includes('Invalid email')) {
                        updateStatus('emailjsStatus', '‚úÖ Template structure is valid (test email rejected as expected)', 'good');
                    } else {
                        updateStatus('emailjsStatus', `‚ùå Template validation failed: ${error.text || error.message}`, 'error');
                    }
                }
            } catch (error) {
                updateStatus('emailjsStatus', `‚ùå Template validation error: ${error.message}`, 'error');
            }
        }

        // Network & Security Functions
        async function checkNetworkConnectivity() {
            updateStatus('networkStatus', 'Checking network connectivity...', 'warning');
            
            const endpoints = [
                { name: 'EmailJS API', url: 'https://api.emailjs.com' },
                { name: 'SMTP Server', url: 'https://mail.privateemail.com' },
                { name: 'Local Email Service', url: CONFIG.emailServiceUrl }
            ];

            let report = 'Network Connectivity Report:\n\n';
            
            for (const endpoint of endpoints) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 5000);
                    
                    const response = await fetch(endpoint.url, {
                        method: 'HEAD',
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    report += `‚úÖ ${endpoint.name}: Accessible\n`;
                } catch (error) {
                    if (error.name === 'AbortError') {
                        report += `‚ùå ${endpoint.name}: Timeout (5s)\n`;
                    } else {
                        report += `‚ùå ${endpoint.name}: ${error.message}\n`;
                    }
                }
            }

            updateStatus('networkStatus', report, 'info');
        }

        async function checkFirewallPorts() {
            updateStatus('networkStatus', 'Checking firewall ports...', 'warning');
            
            const ports = [
                { port: 587, name: 'SMTP (STARTTLS)' },
                { port: 465, name: 'SMTP (SSL)' },
                { port: 3001, name: 'Local Email Service' },
                { port: 443, name: 'HTTPS (EmailJS)' }
            ];

            let report = 'Port Accessibility Report:\n\n';
            
            for (const portInfo of ports) {
                // Note: Direct port testing from browser is limited due to CORS
                report += `${portInfo.name} (Port ${portInfo.port}): Cannot test directly from browser\n`;
            }
            
            report += '\nTo test ports manually:\n';
            report += '1. Open Command Prompt as Administrator\n';
            report += '2. Test SMTP: telnet mail.privateemail.com 587\n';
            report += '3. Test HTTPS: curl -I https://api.emailjs.com\n';
            report += '4. Test Local Service: curl http://localhost:3001/health\n';

            updateStatus('networkStatus', report, 'info');
        }

        async function checkDNSResolution() {
            updateStatus('networkStatus', 'Checking DNS resolution...', 'warning');
            
            const domains = ['mail.privateemail.com', 'api.emailjs.com', 'localhost'];
            let report = 'DNS Resolution Report:\n\n';
            
            for (const domain of domains) {
                try {
                    // Simple connectivity test as a proxy for DNS resolution
                    const start = Date.now();
                    await fetch(`https://${domain}`, { method: 'HEAD', mode: 'no-cors' });
                    const time = Date.now() - start;
                    report += `‚úÖ ${domain}: Resolved (${time}ms)\n`;
                } catch (error) {
                    report += `‚ùå ${domain}: ${error.message}\n`;
                }
            }

            updateStatus('networkStatus', report, 'info');
        }

        // Email Logs Functions
        async function fetchEmailLogs() {
            document.getElementById('emailLogs').textContent = 'Fetching email logs...';
            
            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/logs`);
                if (response.ok) {
                    const logs = await response.text();
                    document.getElementById('emailLogs').textContent = logs || 'No logs available';
                } else {
                    document.getElementById('emailLogs').textContent = `‚ùå Failed to fetch logs: ${response.status}`;
                }
            } catch (error) {
                document.getElementById('emailLogs').textContent = `‚ùå Error fetching logs: ${error.message}`;
            }
        }

        async function clearEmailLogs() {
            document.getElementById('emailLogs').textContent = 'Clearing email logs...';
            
            try {
                const response = await fetch(`${CONFIG.emailServiceUrl}/clear-logs`, {
                    method: 'POST'
                });
                if (response.ok) {
                    document.getElementById('emailLogs').textContent = '‚úÖ Logs cleared successfully';
                } else {
                    document.getElementById('emailLogs').textContent = `‚ùå Failed to clear logs: ${response.status}`;
                }
            } catch (error) {
                document.getElementById('emailLogs').textContent = `‚ùå Error clearing logs: ${error.message}`;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üîß SMTP Diagnostic Tool loaded');
            
            // Auto-check service status on load
            setTimeout(checkServiceStatus, 1000);
        });
    </script>
    
    <!-- EmailJS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</body>
</html>
