<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Dreamex Datalab HSE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Firebase v8 CDN for compatibility -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <!-- GitHub Pages Fix Script -->
    <script src="github-pages-fix.js"></script>
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>Dreamex Datalab</h1>
                <p>HSE Management System</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="email">Email</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <div class="input-with-icon">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="password" name="password" required>
                    </div>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-login">Login</button>
                </div>
                <div id="loginError" class="error-message"></div>
            </form>
        </div>
    </div>

    <ul class="menu">
        <li class="menu-dropdown" data-feature="health_view">
            <a href="#"><i class="fas fa-medkit"></i> Health</a>
            <ul class="submenu">
                <li data-feature="health_assessment_view"><a href="health-assessment.html">Assessment</a></li>
                <li data-feature="health_consultation_view"><a href="health-consultation.html">Consultation</a></li>
                <li data-feature="medical_folder_view"><a href="medical-folder.html">Medical Folder</a></li>
            </ul>
        </li>
        <li class="menu-dropdown" data-feature="safety_view">
            <a href="#"><i class="fas fa-shield-alt"></i> Safety</a>
            <ul class="submenu">
                <li data-feature="training_view"><a href="trainingboard.html">Training</a></li>
                <li><a href="jsaboard.html">Job Safety Analysis</a></li>
                <li><a href="ptwboard.html">Permit to Work</a></li>
                <li><a href="incidentboard.html">Incident Reports</a></li>
            </ul>
        </li>
        <li class="menu-dropdown" data-feature="risk_view">
            <a href="#"><i class="fas fa-exclamation-triangle"></i> Risk Management</a>
            <ul class="submenu">
                <li data-feature="risk_view"><a href="riskboard.html">Risk Management</a></li>
            </ul>
        </li>
        <li class="menu-dropdown" data-feature="environment_view">
            <a href="#"><i class="fas fa-leaf"></i> Environment</a>
            <ul class="submenu">
                <li data-feature="water_view"><a href="waterboard.html">Water Quality</a></li>
            </ul>
        </li>
        <li class="menu-dropdown" data-feature="security_view">
            <a href="#"><i class="fas fa-lock"></i> Security</a>
            <ul class="submenu">
                <li data-feature="access_view"><a href="accessboard.html">Access Request</a></li>
                <li data-feature="access_daily_view"><a href="accessdaily.html">Daily Access Control</a></li>
                <li data-feature="removal_view"><a href="removalboard.html">Property Removal</a></li>
            
						<li data-feature="security_level_evaluation_view" data-requires-permission="security_level_evaluation_view"><a href="seclevel.html">Security Level Evaluation</a></li></ul>
        </li>
        <li class="menu-dropdown" data-feature="settings_view">
            <a href="#"><i class="fas fa-cog"></i> Settings</a>
            <ul class="submenu">
                <li data-feature="account_settings_view"><a href="account.html">Account Settings</a></li>
                <li data-feature="company_management_view"><a href="companyboard.html">Company Management</a></li>
                <li data-feature="approval_settings_view"><a href="approval-settings.html">Approval Flow Settings</a></li>
                <li data-feature="field_setup_view"><a href="fieldsetup.html">Field Setup</a></li>
                <li data-feature="preferences_view"><a href="preferences.html">Preferences</a></li>
                <li data-feature="notification_settings_view"><a href="notification-settings.html">Notification Settings</a></li>
                <li data-feature="audit_log_view"><a href="auditlog.html"><i class="fas fa-history"></i> Audit Log</a></li>
                <li data-feature="user_management_view"><a href="users.html">User & Role Management</a></li>
                <li data-feature="role_permissions_view"><a href="roles.html">Role Permissions</a></li>
            </ul>
        </li>
    </ul>

    <script type="module" src="js/auth.js"></script>

<script>
// Error handling for missing resources
window.addEventListener('error', function(e) {
  console.error('Resource loading error:', e.target.src || e.target.href);
  
  // Handle missing CSS files
  if (e.target.tagName === 'LINK' && e.target.rel === 'stylesheet') {
    console.warn('CSS file not found:', e.target.href);
  }
  
  // Handle missing JS files
  if (e.target.tagName === 'SCRIPT') {
    console.warn('JavaScript file not found:', e.target.src);
  }
});

// Check if critical files are loaded
document.addEventListener('DOMContentLoaded', function() {
  // Check if main CSS is loaded
  const stylesheets = document.querySelectorAll('link[rel="stylesheet"]');
  let mainCssLoaded = false;
  
  stylesheets.forEach(function(link) {
    if (link.href.includes('css/styles.css')) {
      mainCssLoaded = true;
    }
  });
  
  if (!mainCssLoaded) {
    console.warn('Main CSS file (css/styles.css) may not be loaded properly');
  }
});
</script>
</body>
</html>
